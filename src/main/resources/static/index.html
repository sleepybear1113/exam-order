<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>核对单</title>
    <script src="js/lib/vue.js"></script>
    <script src="js/lib/axios.min.js"></script>
    <script src="js/utils/util.js"></script>
    <script src="js/classes.js"></script>
</head>
<style>
    .info {
        margin: -2px;
    }

    .number-input {
        width: 50px;
    }

    .table-title {
        font-size: 18px;
        margin: 0;
    }

    @media print {
        .no-print {
            display: none;
        }
    }
</style>
<body>
<div id="app">
    <div class="no-print">
        <label>字体大小: {{infoFontSize}}</label>&nbsp;&nbsp;&nbsp;&nbsp;
        <label>
            每行数量
            <input v-model="colCount" type="number" class="number-input">
        </label>&nbsp;&nbsp;&nbsp;
        <label>
            图片大小
            <input v-on:change="adjustImgSize()" v-on:input="adjustImgSize()" v-model="imgWidth" type="number" class="number-input">
        </label>
        <br/>
        <button v-on:click="changeInfoFontSize(1)">+</button>
        <button v-on:click="changeInfoFontSize(-1)">-</button>
        <hr>

        <table>
            <thead>
            <tr>
                <td>
                    科目类别
                </td>
                <td>
                    科目类别名
                </td>
                <td>
                    最大数量
                </td>
            </tr>
            </thead>
            <template v-for="subjectCount in subjectInfoMaxCountList">
                <tr>
                    <td>
                        {{subjectCount.subjectType}}
                    </td>
                    <td>
                        {{subjectCount.subjectTypeName}}
                    </td>
                    <td>
                        <label>
                            <input v-model="subjectCount.maxCount" type="number" class="number-input">
                        </label>
                    </td>
                </tr>
            </template>
        </table>
        <button v-on:click="change()">修改数量</button>

        <hr>
        <hr>

        <button v-on:click="processPic(0)">顺序生成</button>
        <button v-on:click="processPic(Math.ceil(Math.random() * 10000000000))">随机生成</button>
        <br/>
        <button v-on:click="processPic(random)">使用右侧随机数生成</button>
        <label>
            <input type="number" v-model="random">
        </label>
        <hr>
        <label for="ww">核对单表头</label><input id="ww" v-model="tableTitle">
        <hr>
        <button onclick="window.print()">打印</button>
        <button v-on:click="exportExcel()">导出Excel</button>
        <hr>
        <hr>
    </div>

    <div id="tables2" class="print">
        <template v-for="examPlaceInfo in examPlaceInfoList">

            <!--单个科目全部试场-->
            <template v-for="subjectInfo in examPlaceInfo.list">

                <!--科目下的单个试场-->
                <template v-for="(examRoomInfo, index) in subjectInfo.examRoomInfoList">
                    <table>
                        <caption>
                            <div style="margin-bottom: -10px;">
                                <p class="table-title">{{tableTitle}}</p>
                                <!--考点-科目-试场号-->
                                <span style="float: left">
                                        考点：{{examPlaceInfo.examPlaceName}}
                                </span>
                                <span>
                                        {{subjectInfo.subjectTypeName}}（{{subjectInfo.subjectType}}）
                                </span>
                                <span style="float: right">
                                    试场：{{examRoomInfo.roomName == null ? addPrefixZero(index + 1, 3) : examRoomInfo.roomName}}
                                </span>
                            </div>
                        </caption>
                        <template></template>

                        <!--单个考点下若干行-->
                        <template v-for="row in Math.ceil(examRoomInfo.list.length / colCount)">
                            <tr>
                                <!--每行具体内容-->
                                <template v-for="(person, col) in examRoomInfo.list.slice((row - 1) * colCount, row * colCount)">
                                    <td>
                                        <img :src="picHost + person.picSrc" alt="" :width="imgWidth + 'px'" :height="imgHeight + 'px'" style="margin-right: 40px; margin-bottom: 0; margin-top: 12px;">
                                        <p class="info">{{person.examNumber}}&nbsp;&nbsp;</p>
                                        <p class="info">{{person.name}}</p>
                                        <p class="info">{{(person.seatNo == null || person.seatNo === "")? addPrefixZero(((row - 1) * colCount + col + 1), 2): person.seatNo}}</p>
                                    </td>
                                </template>

                                <!--最后一行补充空白-->
                                <template v-if="(row * colCount) > examRoomInfo.list.length">
                                    <template v-for="row in (colCount - examRoomInfo.list.length % colCount)">
                                        <!--空白行-->
                                        <td>
                                            <img :src="emptyPng" alt=" " :width="imgWidth + 'px'" :height="imgHeight + 'px'" style="margin-right: 40px; margin-bottom: 0; margin-top: 12px; border: none">
                                        </td>
                                    </template>

                                </template>
                            </tr>
                        </template>

                    </table>
                    <div style="page-break-after:always;"></div>
                </template>
            </template>
        </template>
    </div>
</div>

<script src="js/index.js"></script>
</body>
</html>